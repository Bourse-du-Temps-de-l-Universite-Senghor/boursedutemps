
import React, { useState, useEffect } from 'react';
import { Page, User, Service, Request, BlogPost, Testimonial, ForumTopic, Transaction, Connection, ChatMessage } from './types';
import Navbar from './components/Navbar';
import Home from './pages/Home';
import About from './pages/About';
import ServicesPage from './pages/ServicesPage';
import RequestsPage from './pages/RequestsPage';
import Members from './pages/Members';
import Forum from './pages/Forum';
import Blog from './pages/Blog';
import Testimonials from './pages/Testimonials';
import Profile from './pages/Profile';
import Moderation from './pages/Moderation';
import AuthModal from './components/AuthModal';

const ADMIN_EMAIL = 'jean.pierre-louis.2025@etu-usenghor.org';

const PRIVACY_TEXT = `POLITIQUE DE CONFIDENTIALITÉ – Bourse du Temps
1. Introduction
Le site Bourse du Temps (https://boursedutemps.netlify.app/) accorde une grande importance à la protection de vos données personnelles.
La présente Politique de Confidentialité explique quelles informations nous collectons, comment nous les utilisons et quels sont vos droits.
En utilisant notre site, vous acceptez les pratiques décrites ci-dessous.

2. Données collectées
2.1 Données fournies volontairement
Lorsque vous utilisez notre formulaire de contact, nous collectons :
• 	Nom et prénom
• 	Adresse e‑mail
• 	Message ou informations que vous choisissez de nous transmettre
2.2 Données collectées automatiquement
Lors de votre navigation au site :
• 	Adresse IP
• 	Type de navigateur et appareil
• 	Pages consultées
• 	Données analytiques anonymisées
• 	Cookies techniques et analytiques

3. Finalités de la collecte
Les données collectées servent à :
• 	Répondre à vos demandes via le formulaire
• 	Améliorer l’expérience utilisateur
• 	Assurer le fonctionnement technique du site
• 	Analyser l’audience et les performances du site
Aucune donnée n’est utilisée à des fins commerciales.

4. Partage des données
Vos données ne sont jamais vendues.
Elles peuvent être partagées uniquement avec :
• 	Notre hébergeur
• 	Nos outils techniques (ex : Netlify, services d’analyse)
• 	Les autorités légales en cas d’obligation

5. Cookies
Le site utilse des cookies pour :
• 	Assurer son bon fonctionnement
• 	Mesurer l’audience
• 	Optimiser les performances
Vous pouvez désactiver les cookies via les paramètres de votre navigateur.

6. Sécurité
Nous mettons en place des mesures techniques pour protéger vos données contre :
• 	L’accès non autorisé
• 	La perte
• 	La modification
• 	La divulgation

7. Durée de conservation
Les données envoyées via le formulaire sont conservées uniquement le temps nécessaire au traitement de votre demande.

MENTIONS LÉGALES – Bourse du Temps
1. Éditeur du site
Nom / Raison sociale : PIERRE LOUIS Jean Bernard
Adresse : Université Senghor
Quartier des Universités - Axe Central
Ville Borg El-Arab El-Gedida - 5220220 Égypte
Email : jean.pierre-louis.2025@etu-usenghor.org
Téléphone : +509 32 27 4422

2. Directeur de la publication
PIERRE LOUIS Jean Bernard 

3. Hébergeur
Le site est hébergé par :
Netlify, Inc.
2325 3rd Street, Suite 296
San Francisco, CA 94107
Site : https://www.netlify.com/

4. Propriété intellectuelle
Tous les contenus présents sur le site (textes, images, logos, design) sont protégés par le droit d’auteur.
Toute reproduction sans autorisation est interdite.

5. Responsabilité
L’éditeur ne peut être tenu responsable :
• 	D’interruptions du site
• 	D’erreurs ou omissions dans le contenu
• 	De dommages liés à l’utilisation du site
• 	Des liens externes présents sur le site

CONDITIONS GÉNÉRALES D’UTILISATION (CGU)
1. Objet
Les présentes CGU encadrent l’utilisation du site Bourse du Temps.

2. Accès au site
Le site est accessible gratuitement à tout (e) auditeur (trice) du campus de l'Université Senghor à Alexandrie.

3. Services proposés
Le site propose :
• 	Des informations sur le concept Bourse du Temps
• 	Un formulaire de contact
• 	Une présentation des services
Aucune transaction monétaire n’est effectuée sur le site.

4. Obligations de l’utilisateur
L’utilisateur s’engage à :
• 	Ne pas utiliser le site à des fins illégales
• 	Ne pas tenter d’accéder aux données d’autres utilisateurs
• 	Fournir des informations exactes via le formulaire

5. Propriété intellectuelle
Tous les contenus du site sont protégés.
Toute reproduction est interdite sans autorisation écrite.

6. Données personnelles
L’utilisation du site implique l’acceptation de notre Politique de Confidentialité.

7. Limitation de responsabilité
Nous ne garantissons pas :
• 	L’absence d’erreurs
• 	La disponibilité permanente du site
• 	L’exactitude des informations

8. Modification des CGU
Les CGU peuvent être modifiées à tout moment.
La version en vigueur est celle affichée sur le site.

9. Droit applicable
Les présentes CGU sont soumises au droit égyptien et aux règlements de l'Université Senghor à Alexandrie.`;

const TERMS_TEXT = `LOI DE CONDITIONS D’ÉCHANGE – BOURSE DU TEMPS
1. Objet de la Loi
La présente Loi de Conditions d’Échange a pour objectif d’encadrer les échanges de services, de compétences et de temps entre les utilisateurs du site Bourse du Temps (https://boursedutemps.netlify.app).
Elle définit les droits, obligations et responsabilités de chaque participant afin de garantir un environnement sûr, équitable et respectueux.

2. Définitions
• 	Utilisateur : toute personne accédant au site ou participant à un échange.
• 	Offreur : utilisateur proposant un service ou une compétence.
• 	Demandeur : utilisateur sollicitant un service ou une compétence.
• 	Échange : prestation réalisée entre deux utilisateurs, basée un principe de temps contre temps ou service contre service.
• 	Crédit‑Temps : unité symbolique représentant la valeur d’un échange (si applicable).

3. Nature des Échanges
3.1 Gratuité
Les échanges réalisés via Bourse du Temps sont non commerciaux.
Aucun paiement financier ne peut être exigé ou proposé.
3.2 Réciprocité
Les échanges reposent sur un principe d’équité :
• 	un service rendu peut être compensé par un autre service,
• 	ou par un temps équivalent, selon les modalités convenues entre les utilisateurs.
3.3 Liberté contractuelle
Les utilisateurs sont libres de :
• 	choisir leurs partenaires d’échange,
• 	définir les modalités de l’échange,
• 	refuser un échange sans justification.

4. Engagements des Utilisateurs
4.1 Respect et courtoisie
Chaque utilisateur s’engage à adopter un comportement respectueux, bienveillant et non discriminatoire.
4.2 Exactitude des informations
Les utilisateurs doivent fournir des informations sincères concernant :
• 	leurs compétences,
• 	leur disponibilité,
• 	leur identité.
4.3 Sécurité
Les utilisateurs doivent veiller à leur propre sécurité et ne pas proposer :
• 	de services illégaux,
• 	de services dangereux,
• 	de services nécessitant une qualification professionnelle réglementée (ex : médecine, droit, électricité haute tension).

5. Responsabilités
5.1 Responsabilité de l’éditeur
Le site Bourse du Temps :
• 	n’intervient pas dans les échanges,
• 	ne garantit pas la qualité des services,
• 	ne peut être tenu responsable des litiges entre utilisateurs.
5.2 Responsabilité des utilisateurs
Les utilisateurs sont seuls responsables :
• 	des engagements qu’ils prennent,
• 	de la qualité des services rendus,
• 	des conséquences de leurs actions.

6. Confidentialité et Données
Les échanges doivent respecter la vie privée de chacun.
Aucune donnée personnelle obtenue dans le cadre d’un échange ne peut être :
• 	divulguée,
• 	vendue,
• 	utilisée à des fins commerciales.

7. Annulation et Litiges
7.1 Annulation
Un utilisateur peut annuler un échange, mais doit prévenir l’autre partie dans un délai raisonnable.
7.2 Litiges
En cas de désaccord, les utilisateurs doivent tenter une résolution amiable.
Le site n’intervient pas dans les conflits.

8. Interdictions
Il est strictement interdit de :
• 	proposer des services illégaux,
• 	exiger une rémunération financière,
• 	usurper l’identité d’un tiers,
• 	harceler ou menacer un autre utilisateur,
• 	détourner le site à des fins commerciales.

9. Suspension ou Exclusion
L’éditeur du site se réserve le droit de suspendre ou supprimer l’accès d’un utilisateur en cas de :
• 	non‑respect de la Loi,
• 	comportement dangereux,
• 	fraude ou tentative de fraude.

10. Modification de la Loi
La présente Loi peut être modifiée à tout moment.
La version en vigueur est celle publiée sur le site.

11. Acceptation
L’utilisation du site implique l’acceptation pleine et entière de la présente Loi de Conditions d’Échange.

CHARTE ÉTHIQUE – BOURSE DU TEMPS
Préambule
La communauté Bourse du Temps repose sur un principe simple : chacun possède du temps, des talents et des compétences qui peuvent bénéficier aux autres.
 Cette Charte Éthique établit les valeurs fondamentales qui guident les échanges entre les membres.
 En utilisant le site, chaque utilisateur s’engage à respecter ces principes.
1. Respect et Bienveillance
Chaque membre s’engage à :
traiter les autres avec courtoisie et respect
adopter une attitude positive et non discriminatoire
écouter, comprendre et communiquer de manière constructive
Aucun comportement agressif, humiliant ou irrespectueux n’est toléré.
2. Confiance et Transparence
La confiance est la base de tout échange.
 Les utilisateurs doivent :
fournir des informations sincères sur leurs compétences et disponibilités
respecter les engagements pris
prévenir en cas d’imprévu ou d’annulation
La transparence renforce la qualité des échanges.
3. Équité et Réciprocité
Les échanges doivent être :
équitables
équilibrés
basés sur la réciprocité
Chaque service rendu doit être compensé par un autre service ou un temps équivalent, selon les modalités convenues librement entre les utilisateurs.
4. Gratuité des Échanges
La Bourse du Temps repose sur un principe fondamental :
aucune transaction financière n’est autorisée
aucun utilisateur ne peut exiger ou proposer une rémunération en argent
Les échanges sont basés uniquement sur le temps, l’entraide et la solidarité.
5. Sécurité et Responsabilité
Chaque utilisateur doit :
veiller à sa propre sécurité
ne proposer que des services qu’il maîtrise réellement
ne pas s’engager dans des activités dangereuses ou illégales
Les services nécessitant une qualification professionnelle réglementée (médecine, droit, travaux électriques complexes, etc.) sont interdits.
6. Confidentialité et Respect de la Vie Privée
Les informations échangées entre utilisateurs doivent rester confidentielles.
 Il est strictement interdit de :
divulguer des données personnelles
enregistrer ou publier des échanges sans consentement
utiliser les informations obtenues à des fins commerciales ou malveillantes
La confiance passe par la discrétion.
7. Inclusion et Non‑Discrimination
La communauté est ouverte à tous, sans distinction de :
sexe
âge
origine
religion
situation sociale
handicap
Toute forme de discrimination est strictement interdite.
8. Engagement envers la Qualité
Chaque utilisateur s’engage à :
fournir un service de qualité
respecter les délais convenus
faire preuve de sérieux et de professionnalisme
Un échange réussi renforce la communauté.
9. Résolution des Conflits
En cas de désaccord, les utilisateurs doivent :
privilégier le dialogue
rechercher une solution amiable
faire preuve de compréhension
Le site n’intervient pas dans les litiges, mais encourage la communication respectueuse.
10. Contribution à la Communauté
Chaque membre contribue à faire de Bourse du Temps un espace :
utile
solidaire
respectueux
enrichissant pour tous
L’esprit d’entraide est au cœur du projet.
11. Acceptation de la Charte
L’utilisation du site implique l’acceptation pleine et entière de la présente Charte Éthique.
 Tout manquement peut entraîner une suspension ou une exclusion de la plateforme.`;

const INITIAL_BLOGS: BlogPost[] = [
  { 
    id: '1', 
    authorId: 'admin',
    authorName: 'Admin', 
    authorAvatar: 'https://i.postimg.cc/5Y3Rg6zs/image-1.jpg',
    title: 'Échange de compétences en cours !', 
    content: 'Une superbe session de partage aujourd\'hui au campus. L\'entraide est au cœur de notre communauté.', 
    category: 'Succès', 
    media: [{ type: 'image', url: 'https://i.postimg.cc/47b9W4tg/IMG-20260110-WA0161.jpg' }],
    likes: [],
    dislikes: [],
    reposts: 0,
    comments: [],
    createdAt: new Date().toISOString() 
  },
  { 
    id: '2', 
    authorId: 'admin',
    authorName: 'Admin', 
    authorAvatar: 'https://i.postimg.cc/5Y3Rg6zs/image-1.jpg',
    title: 'Moment de convivialité à Senghor', 
    content: 'Les échanges ne sont pas que techniques, ils sont aussi humains.', 
    category: 'Expérience', 
    media: [{ type: 'image', url: 'https://i.postimg.cc/2V31Z7HL/IMG-20260123-WA0248.jpg' }],
    likes: [],
    dislikes: [],
    reposts: 0,
    comments: [],
    createdAt: new Date(Date.now() - 86400000).toISOString() 
  },
  { 
    id: '3', 
    authorId: 'admin',
    authorName: 'Admin', 
    authorAvatar: 'https://i.postimg.cc/5Y3Rg6zs/image-1.jpg',
    title: 'Nouveau projet collaboratif', 
    content: 'Découvrez comment nos membres s\'organisent pour de nouveaux défis.', 
    category: 'Actualité', 
    media: [{ type: 'image', url: 'https://i.postimg.cc/23ykc8nP/IMG-20260122-WA0308.jpg' }],
    likes: [],
    dislikes: [],
    reposts: 0,
    comments: [],
    createdAt: new Date(Date.now() - 172800000).toISOString() 
  },
  { 
    id: '4', 
    authorId: 'admin',
    authorName: 'Admin', 
    authorAvatar: 'https://i.postimg.cc/5Y3Rg6zs/image-1.jpg',
    title: 'Atelier pratique', 
    content: 'Apprendre les uns des autres, c\'est progresser ensemble.', 
    category: 'Tutoriel', 
    media: [{ type: 'image', url: 'https://i.postimg.cc/f3MtJn1w/IMG-20251229-WA0014.jpg' }],
    likes: [],
    dislikes: [],
    reposts: 0,
    comments: [],
    createdAt: new Date(Date.now() - 259200000).toISOString() 
  },
  { 
    id: '5', 
    authorId: 'admin',
    authorName: 'Admin', 
    authorAvatar: 'https://i.postimg.cc/5Y3Rg6zs/image-1.jpg',
    title: 'Rétrospective de fin d\'année', 
    content: 'Un grand merci à tous ceux qui ont contribué à faire vivre la Bourse du Temps.', 
    category: 'Succès', 
    media: [{ type: 'image', url: 'https://i.postimg.cc/sBnXxBpM/IMG-20251231-WA0144.jpg' }],
    likes: [],
    dislikes: [],
    reposts: 0,
    comments: [],
    createdAt: new Date(Date.now() - 345600000).toISOString() 
  }
];

const INITIAL_TESTIMONIALS: Testimonial[] = [
  { 
    id: '1', 
    authorId: 'alice', 
    authorName: 'Alice', 
    authorAvatar: '',
    title: 'Négociation réussie !', 
    content: 'J\'ai pu échanger 3 crédits pour un service complexe contre une aide simple. Le système de suivi est parfait.', 
    rating: 5, 
    votes: [], 
    createdAt: new Date().toISOString() 
  },
];

const App: React.FC = () => {
  const [currentPage, setCurrentPage] = useState<Page>('home');
  const [user, setUser] = useState<User | null>(null);
  const [users, setUsers] = useState<User[]>([]);
  const [services, setServices] = useState<Service[]>([]);
  const [requests, setRequests] = useState<Request[]>([]);
  const [blogs, setBlogs] = useState<BlogPost[]>([]);
  const [testimonials, setTestimonials] = useState<Testimonial[]>([]);
  const [forumTopics, setForumTopics] = useState<ForumTopic[]>([]);
  const [transactions, setTransactions] = useState<Transaction[]>([]);
  const [connections, setConnections] = useState<Connection[]>([]);
  const [messages, setMessages] = useState<ChatMessage[]>([]);
  const [showAuthModal, setShowAuthModal] = useState<'login' | 'signup' | null>(null);
  const [viewingUserId, setViewingUserId] = useState<string | null>(null);
  const [showTermsModal, setShowTermsModal] = useState(false);
  const [showPrivacyModal, setShowPrivacyModal] = useState(false);
  const [showHelpModal, setShowHelpModal] = useState(false);

  // Formulaire d'aide
  const [helpType, setHelpType] = useState<'Aide' | 'Signalement'>('Aide');
  const [helpSubject, setHelpSubject] = useState('');
  const [helpMessage, setHelpMessage] = useState('');

  useEffect(() => {
    const savedUsers = localStorage.getItem('stb_users');
    const savedServices = localStorage.getItem('stb_services');
    const savedRequests = localStorage.getItem('stb_requests');
    const savedTransactions = localStorage.getItem('stb_transactions');
    const savedConnections = localStorage.getItem('stb_connections');
    const savedMessages = localStorage.getItem('stb_messages');
    const savedBlogs = localStorage.getItem('stb_blogs');
    const savedTestimonials = localStorage.getItem('stb_testimonials');
    
    if (savedUsers) setUsers(JSON.parse(savedUsers));
    if (savedServices) setServices(JSON.parse(savedServices));
    if (savedRequests) setRequests(JSON.parse(savedRequests));
    if (savedTransactions) setTransactions(JSON.parse(savedTransactions));
    if (savedConnections) setConnections(JSON.parse(savedConnections));
    if (savedMessages) setMessages(JSON.parse(savedMessages));
    setBlogs(savedBlogs ? JSON.parse(savedBlogs) : INITIAL_BLOGS);
    setTestimonials(savedTestimonials ? JSON.parse(savedTestimonials) : INITIAL_TESTIMONIALS);
  }, []);

  const triggerNotification = (targetUser: User, type: string, fromName: string) => {
    console.log(`Notification sent to ${targetUser.email} and ${targetUser.whatsapp}`);
    alert(`[Notification Simulation]\nDestinataire: ${targetUser.firstName}\nCanal: WhatsApp & Gmail\nMessage: ${fromName} vous a envoyé une ${type}.`);
  };

  const handleAuth = (loggedInUser: User) => {
    let finalUser = loggedInUser;
    if (loggedInUser.email === ADMIN_EMAIL) {
      finalUser = { ...loggedInUser, role: 'admin' };
    }
    setUser(finalUser);
    setShowAuthModal(null);
    const existing = users.find(u => u.email === finalUser.email);
    if (!existing) {
      const updatedUsers = [...users, finalUser];
      setUsers(updatedUsers);
      localStorage.setItem('stb_users', JSON.stringify(updatedUsers));
    } else {
      setUser({ ...finalUser, role: existing.role || finalUser.role });
    }
  };

  const handleTransaction = (item: Service | Request, negotiatedAmount: number, type: 'service' | 'request') => {
    if (!user) { setShowAuthModal('login'); return; }
    
    const buyerId = type === 'service' ? user.id : item.userId;
    const providerId = type === 'service' ? item.userId : user.id;
    
    const buyer = users.find(u => u.id === buyerId);
    if (!buyer || buyer.credits < negotiatedAmount) {
      alert("Erreur : Crédits insuffisants pour finaliser cette négociation.");
      return;
    }

    const updatedUsers = users.map(u => {
      if (u.id === buyerId) return { ...u, credits: u.credits - negotiatedAmount };
      if (u.id === providerId) return { ...u, credits: u.credits + negotiatedAmount };
      return u;
    });

    const newTransaction: Transaction = {
      id: Math.random().toString(36).substr(2, 9),
      fromId: buyerId,
      toId: providerId,
      amount: negotiatedAmount,
      serviceTitle: item.title,
      type: type,
      date: new Date().toISOString()
    };

    const newTransactions = [newTransaction, ...transactions];
    setUsers(updatedUsers);
    localStorage.setItem('stb_users', JSON.stringify(updatedUsers));
    setTransactions(newTransactions);
    localStorage.setItem('stb_transactions', JSON.stringify(newTransactions));
    
    const updatedMe = updatedUsers.find(u => u.id === user.id);
    if (updatedMe) setUser(updatedMe);

    const target = users.find(u => u.id === item.userId);
    if (target) triggerNotification(target, type === 'service' ? "proposition de service" : "demande de service", user.firstName);

    alert(`Succès ! ${negotiatedAmount} crédits ont été transférés.`);
  };

  const handleHelpSubmit = (e: React.FormEvent) => {
    e.preventDefault();
    alert(`Merci ! Votre demande (${helpType} : ${helpSubject}) a été transmise à l'administrateur. Nous reviendrons vers vous rapidement sur ${user?.email || 'votre email'}.`);
    setShowHelpModal(false);
    setHelpSubject('');
    setHelpMessage('');
  };

  const renderPage = () => {
    switch (currentPage) {
      case 'home': return <Home navigate={setCurrentPage} blogs={blogs} testimonials={testimonials} />;
      case 'about': return <About />;
      case 'services': return <ServicesPage user={user} services={services} onAdd={(s) => setServices([s, ...services])} onBuy={(s, amt) => handleTransaction(s, amt, 'service')} />;
      case 'requests': return <RequestsPage user={user} requests={requests} onAdd={(r) => setRequests([r, ...requests])} onFulfill={(r, amt) => handleTransaction(r, amt, 'request')} />;
      case 'members': return <Members users={users} onViewProfile={(uid) => { setViewingUserId(uid); setCurrentPage('profile-view'); }} />;
      case 'forum': return <Forum user={user} topics={forumTopics} onAdd={(t) => setForumTopics([t, ...forumTopics])} />;
      case 'blog': return <Blog blogs={blogs} onUpdate={(b) => { setBlogs(b); localStorage.setItem('stb_blogs', JSON.stringify(b)); }} user={user} onAuthClick={() => setShowAuthModal('login')} />;
      case 'testimonials': return <Testimonials testimonials={testimonials} onUpdate={(t) => { setTestimonials(t); localStorage.setItem('stb_testimonials', JSON.stringify(t)); }} user={user} onAuthClick={() => setShowAuthModal('login')} />;
      case 'profile': return user ? <Profile user={user} allUsers={users} transactions={transactions} connections={connections} messages={messages} onUpdate={setUser} onUpdateConnections={setConnections} onUpdateMessages={setMessages} /> : <Home navigate={setCurrentPage} blogs={blogs} testimonials={testimonials} />;
      case 'profile-view': 
        const target = users.find(u => u.id === viewingUserId);
        return target ? <Profile user={target} currentUser={user} allUsers={users} transactions={transactions} connections={connections} messages={messages} onUpdate={() => {}} onUpdateConnections={setConnections} onUpdateMessages={setMessages} readOnly /> : <Members users={users} onViewProfile={() => {}} />;
      case 'moderation': return <Moderation users={users} onUpdateUsers={setUsers} services={services} onUpdateServices={setServices} requests={requests} onUpdateRequests={setRequests} currentUser={user!} />;
      default: return <Home navigate={setCurrentPage} blogs={blogs} testimonials={testimonials} />;
    }
  };

  return (
    <div className="min-h-screen flex flex-col bg-slate-50">
      <Navbar currentPage={currentPage} user={user} onNavigate={setCurrentPage} onLogin={() => setShowAuthModal('login')} onSignup={() => setShowAuthModal('signup')} onLogout={() => setUser(null)} />
      <main className="flex-grow pt-16">
        {renderPage()}
      </main>
      
      <footer className="bg-slate-900 text-slate-400 py-16 px-6 border-t border-slate-800">
        <div className="max-w-7xl mx-auto grid grid-cols-1 md:grid-cols-4 gap-12 items-start">
          <div className="space-y-6">
            <div className="flex items-center gap-3">
              <img src="https://i.postimg.cc/5Y3Rg6zs/image-1.jpg" className="w-14 h-14 rounded-full border-2 border-slate-700 shadow-lg object-cover" alt="Logo" />
              <h3 className="text-white font-heading font-bold text-xl uppercase tracking-wider">BOURSE DU TEMPS</h3>
            </div>
            <p className="text-sm leading-relaxed">
              La plateforme solidaire exclusive de l'Université Senghor. Échangez vos talents, valorisez votre temps.
            </p>
          </div>

          <div>
            <h4 className="text-white font-bold mb-6 uppercase text-xs tracking-widest text-blue-400">Navigation</h4>
            <ul className="space-y-3 text-sm">
              <li onClick={() => setCurrentPage('home')} className="cursor-pointer hover:text-white transition">Accueil</li>
              <li onClick={() => setCurrentPage('services')} className="cursor-pointer hover:text-white transition">Services</li>
              <li onClick={() => setCurrentPage('blog')} className="cursor-pointer hover:text-white transition">Blog interactif</li>
            </ul>
          </div>

          <div>
            <h4 className="text-white font-bold mb-6 uppercase text-xs tracking-widest text-blue-400">Support Admin</h4>
            <p className="text-sm mb-4">Besoin d'aide ou signalement ?</p>
            <button 
              onClick={() => setShowHelpModal(true)}
              className="text-sm text-white font-medium break-all hover:text-blue-400 transition underline decoration-blue-500 underline-offset-4 text-left"
            >
              {ADMIN_EMAIL}
            </button>
          </div>

          <div className="flex flex-col items-center md:items-end gap-6">
            <div className="bg-white p-4 rounded-3xl shadow-xl border border-slate-200">
              <img src="https://i.postimg.cc/z31ChCWm/logo-35-ans-usenghor-signature-1.png" className="h-24 w-auto object-contain" alt="35 ans" />
            </div>
            <p className="text-[10px] uppercase font-bold text-slate-500 tracking-widest text-center md:text-right">Partenaire de l'excellence en Francophonie</p>
          </div>
        </div>

        <div className="max-w-7xl mx-auto mt-16 pt-8 border-t border-slate-800 flex flex-col md:flex-row justify-between items-center gap-4 text-[10px] uppercase font-bold tracking-widest">
          <p>© {new Date().getFullYear()} Université Senghor - Alexandrie. Tous droits réservés.</p>
          <div className="flex gap-6">
            <span 
              className="hover:text-white cursor-pointer underline decoration-blue-500 underline-offset-4"
              onClick={() => setShowPrivacyModal(true)}
            >
              Confidentialité
            </span>
            <span 
              className="hover:text-white cursor-pointer underline decoration-blue-500 underline-offset-4"
              onClick={() => setShowTermsModal(true)}
            >
              Conditions d'échange
            </span>
          </div>
        </div>
      </footer>

      {showAuthModal && (
        <AuthModal mode={showAuthModal} onClose={() => setShowAuthModal(null)} onAuth={handleAuth} onSwitch={setShowAuthModal} />
      )}

      {/* MODALE D'AIDE ET SIGNALEMENT */}
      {showHelpModal && (
        <div className="fixed inset-0 z-[120] flex items-center justify-center p-4">
          <div className="absolute inset-0 bg-slate-900/80 backdrop-blur-sm" onClick={() => setShowHelpModal(false)}></div>
          <div className="relative bg-white w-full max-w-lg rounded-[2rem] p-8 md:p-10 shadow-2xl animate-in zoom-in duration-300">
            <h2 className="font-heading text-2xl font-bold text-slate-900 mb-2 uppercase tracking-tight">Assistance</h2>
            <p className="text-slate-500 text-sm mb-8">Envoyez directement votre message à l'administration.</p>
            
            <form onSubmit={handleHelpSubmit} className="space-y-6">
              <div>
                <label className="block text-[10px] font-bold text-slate-400 uppercase tracking-widest mb-2">Nature de la demande</label>
                <div className="flex gap-4">
                  <button 
                    type="button" 
                    onClick={() => setHelpType('Aide')}
                    className={`flex-1 py-3 rounded-xl font-bold text-xs transition ${helpType === 'Aide' ? 'bg-blue-600 text-white shadow-lg' : 'bg-slate-100 text-slate-500 hover:bg-slate-200'}`}
                  >
                    Aide technique
                  </button>
                  <button 
                    type="button" 
                    onClick={() => setHelpType('Signalement')}
                    className={`flex-1 py-3 rounded-xl font-bold text-xs transition ${helpType === 'Signalement' ? 'bg-red-600 text-white shadow-lg' : 'bg-slate-100 text-slate-500 hover:bg-slate-200'}`}
                  >
                    Signalement
                  </button>
                </div>
              </div>

              <div>
                <label className="block text-[10px] font-bold text-slate-400 uppercase tracking-widest mb-2">Objet</label>
                <input 
                  required 
                  placeholder="Ex: Problème de connexion, Litige..." 
                  className="w-full px-5 py-3 rounded-xl bg-slate-50 border border-slate-100 outline-none focus:ring-2 focus:ring-blue-500" 
                  value={helpSubject}
                  onChange={e => setHelpSubject(e.target.value)}
                />
              </div>

              <div>
                <label className="block text-[10px] font-bold text-slate-400 uppercase tracking-widest mb-2">Votre message</label>
                <textarea 
                  required 
                  placeholder="Détaillez votre demande ici..." 
                  className="w-full px-5 py-3 rounded-xl bg-slate-50 border border-slate-100 outline-none focus:ring-2 focus:ring-blue-500 min-h-[120px]" 
                  value={helpMessage}
                  onChange={e => setHelpMessage(e.target.value)}
                />
              </div>

              <div className="flex gap-4 pt-4">
                <button type="submit" className="flex-1 bg-slate-900 text-white py-4 rounded-xl font-bold hover:bg-blue-600 transition">
                  Envoyer
                </button>
                <button type="button" onClick={() => setShowHelpModal(false)} className="flex-1 bg-slate-100 text-slate-500 py-4 rounded-xl font-bold">
                  Annuler
                </button>
              </div>
            </form>
          </div>
        </div>
      )}

      {/* MODALE DES CONDITIONS D'ÉCHANGE */}
      {showTermsModal && (
        <div className="fixed inset-0 z-[110] flex items-center justify-center p-4">
          <div className="absolute inset-0 bg-slate-900/80 backdrop-blur-sm" onClick={() => setShowTermsModal(false)}></div>
          <div className="relative bg-white w-full max-w-4xl rounded-[2rem] p-8 md:p-12 shadow-2xl flex flex-col max-h-[85vh] animate-in zoom-in duration-300">
            <div className="flex justify-between items-center mb-6">
              <h2 className="font-heading text-2xl font-bold text-slate-900 uppercase tracking-tight">Règlement & Charte</h2>
              <button onClick={() => setShowTermsModal(false)} className="p-2 hover:bg-slate-100 rounded-full transition">
                <svg className="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                  <path strokeLinecap="round" strokeLinejoin="round" strokeWidth="2" d="M6 18L18 6M6 6l12 12" />
                </svg>
              </button>
            </div>
            <div className="overflow-y-auto pr-4 custom-scrollbar">
              <div className="prose prose-slate max-w-none">
                <pre className="whitespace-pre-wrap font-sans text-slate-600 leading-relaxed text-sm md:text-base">
                  {TERMS_TEXT}
                </pre>
              </div>
            </div>
            <div className="mt-8 pt-6 border-t border-slate-100 flex justify-end">
              <button 
                onClick={() => setShowTermsModal(false)}
                className="bg-blue-600 text-white px-10 py-3 rounded-xl font-bold hover:bg-blue-700 transition"
              >
                J'ai lu et compris
              </button>
            </div>
          </div>
        </div>
      )}

      {/* MODALE DE CONFIDENTIALITÉ */}
      {showPrivacyModal && (
        <div className="fixed inset-0 z-[110] flex items-center justify-center p-4">
          <div className="absolute inset-0 bg-slate-900/80 backdrop-blur-sm" onClick={() => setShowPrivacyModal(false)}></div>
          <div className="relative bg-white w-full max-w-4xl rounded-[2rem] p-8 md:p-12 shadow-2xl flex flex-col max-h-[85vh] animate-in zoom-in duration-300">
            <div className="flex justify-between items-center mb-6">
              <h2 className="font-heading text-2xl font-bold text-slate-900 uppercase tracking-tight">Confidentialité & Mentions Légales</h2>
              <button onClick={() => setShowPrivacyModal(false)} className="p-2 hover:bg-slate-100 rounded-full transition">
                <svg className="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                  <path strokeLinecap="round" strokeLinejoin="round" strokeWidth="2" d="M6 18L18 6M6 6l12 12" />
                </svg>
              </button>
            </div>
            <div className="overflow-y-auto pr-4 custom-scrollbar">
              <div className="prose prose-slate max-w-none">
                <pre className="whitespace-pre-wrap font-sans text-slate-600 leading-relaxed text-sm md:text-base">
                  {PRIVACY_TEXT}
                </pre>
              </div>
            </div>
            <div className="mt-8 pt-6 border-t border-slate-100 flex justify-end">
              <button 
                onClick={() => setShowPrivacyModal(false)}
                className="bg-blue-600 text-white px-10 py-3 rounded-xl font-bold hover:bg-blue-700 transition"
              >
                Fermer
              </button>
            </div>
          </div>
        </div>
      )}
    </div>
  );
};

export default App;
